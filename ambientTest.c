#pragma config(Sensor, S1,     sensorColorMid, sensorEV3_Color)
#pragma config(Sensor, S2,     sensorColorRight, sensorEV3_Color, modeEV3Color_Color)
#pragma config(Sensor, S4,     sensorColorLeft, sensorEV3_Color, modeEV3Color_Color)
#pragma config(Motor,  motorA,          left,          tmotorEV3_Large, PIDControl, encoder)
#pragma config(Motor,  motorB,          right,         tmotorEV3_Large, PIDControl, encoder)
//*!!Code automatically generated by 'ROBOTC' configuration wizard               !!*//

#define STATE_DEFAULT 0
#define STATE_TURN_LEFT 1
#define STATE_TURN_RIGHT 2

TLegoColors lastLeftColor;
TLegoColors lastRightColor;

int currentState = STATE_DEFAULT;

void stateDefault()
{
	TLegoColors colorLeft = getColorName(sensorColorLeft);
		TLegoColors colorRight = getColorName(sensorColorRight);

		if (colorLeft == colorWhite
			&& colorRight == colorWhite)
		{
			// drive straight
			displayTextLine(3, "2Weiﬂ");
			setMotorSync(left, right, 0, 30);
		}
		/* else if(colorLeft == colorGreen)
		{
			displayTextLine(2,"Green");
			setMotorSync(left, right, 50, 30);
		}*/
		else if(colorLeft == colorBlack
			&&colorRight == colorBlack)
		{
			displayTextLine(3, "2Black");

			if(lastRightColor == colorBlack && lastLeftColor != colorBlack)
				setMotorSync(left, right, 100, 10);
			else if( lastRightColor != colorBlack && lastLeftColor == colorBlack)
				setMotorSync(left, right, -100, 10);
			else
				setMotorSync(left,right,0,30);
		}
		else if (colorLeft == colorBlack)
		{
			// turn right
			displayTextLine(3, "LeftBlack");
			setMotorSync(left, right, -100, 20);
		}
		else if (colorRight == colorBlack)
		{
			// turn left
			displayTextLine(3, "RightBlack");
			setMotorSync(left, right, 100, 20);
		}

		lastLeftColor = colorLeft;
		lastRightColor = colorRight;
}

task main()
{
	bool run = true;
	while (run)
	{
		switch (currentState)
		{
			case STATE_DEFAULT:
				stateDefault();
				break;

			case STATE_TURN_LEFT:
				break;

			case STATE_TURN_RIGHT:
				break;
		}
	}
}
